CREATE USER stefan1 WITH ENCRYPTED PASSWORD 'admin12@';
GRANT ALL PRIVILEGES ON DATABASE web TO stefan1;
GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA webbd TO stefan1;
GRANT ALL PRIVILEGES ON ALL SEQUENCES IN SCHEMA webbd TO stefan1;


CREATE TYPE categorie_produs AS ENUM( 'comanda speciala', 'aniversara', 'editie limitata','comuna');
CREATE TYPE tipuri_produse AS ENUM('gradina', 'bucatarie', 'garaj');


CREATE TABLE IF NOT EXISTS produse (
   id_produs serial PRIMARY KEY,
   nume VARCHAR(50) UNIQUE NOT NULL,
   descriere TEXT,
   pret NUMERIC(8,2) NOT NULL,  
   tip_produs tipuri_produse DEFAULT 'gradina',
   categorie_prod categorie_produs DEFAULT 'comuna',
   masa INT NOT NULL CHECK (masa>=0),
   dimensiune INT NOT NULL CHECK (dimensiune > 0 ) DEFAULT NULL,
   specificatii_tehnice VARCHAR [], --pot sa nu fie specificare deci nu punem NOT NULL
   uz_multiplu BOOLEAN NOT NULL DEFAULT FALSE,
   reparat String NOT NULL DEFAULT 'nu',
   imagine VARCHAR(300) DEFAULT NULL,
   data_adaugare TIMESTAMP DEFAULT current_timestamp
);

INSERT INTO produse (nume, descriere, pret, tip_produs, categorie_prod, greutate, dimensiune, specificatii_tehnice, uz_multiplu, reparat, imagine, data_adaugare)
VALUES ('Foarfecă de tuns iarbă', 'Foarfecă de tuns iarbă cu lame din oțel inoxidabil', 45.99, 'gradina', 'comuna', 300, 20, ARRAY['lama inoxidabila', 'maner ergonomic'], TRUE, 'nu', 'foarfeca.jpg', current_timestamp);

INSERT INTO produse (nume, descriere, pret, tip_produs, categorie_prod, greutate, dimensiune, specificatii_tehnice, uz_multiplu, reparat, imagine, data_adaugare)
VALUES ('Furtun de gradina', 'Furtun flexibil pentru gradina, rezistent la presiune', 29.99, 'gradina', 'comuna', 200, 15, ARRAY['rezistent la presiune', 'diametru 1/2 inch'], TRUE, 'nu', NULL, current_timestamp);

INSERT INTO produse (nume, descriere, pret, tip_produs, categorie_prod, greutate, dimensiune, specificatii_tehnice, uz_multiplu, reparat, imagine, data_adaugare)
VALUES ('Scaun de gradina', 'Scaun pliabil pentru gradina sau terasa, din material plastic', 19.99, 'gradina', 'comuna', 150, 25, ARRAY['material plastic rezistent'], TRUE, 'nu', 'scaun.jpg', current_timestamp);

INSERT INTO produse (nume, descriere, pret, tip_produs, categorie_prod, greutate, dimensiune, specificatii_tehnice, uz_multiplu, reparat, imagine, data_adaugare)
VALUES ('Pulverizator manual', 'Pulverizator manual pentru stropirea plantelor cu solutii de ingrasaminte sau insecticide', 14.50, 'gradina', 'gradina', 100, NULL, ARRAY['capacitate 1L', 'maner ergonomic'], TRUE, 'nu', 'pulverizator.jpg', current_timestamp);

INSERT INTO produse (nume, descriere, pret, tip_produs, categorie_prod, greutate, dimensiune, specificatii_tehnice, uz_multiplu, reparat, imagine, data_adaugare)
VALUES ('Cort pentru gradina', 'Cort portabil pentru relaxare în grădină sau la picnicuri', 99.99, 'gradina', 'comuna', 500, 19, ARRAY['material impermeabil', 'dimensiuni 3x3 metri'], TRUE, 'nu', 'cort.jpg', current_timestamp);

INSERT INTO produse (nume, descriere, pret, tip_produs, categorie_prod, greutate, dimensiune, specificatii_tehnice, uz_multiplu, reparat, imagine, data_adaugare)
VALUES ('Fertilizator granulat', 'Fertilizator granulat pentru plante de gradina, conținut bogat în azot', 9.99, 'gradina', 'editie limitata', 300, 29, ARRAY['conținut azot 15%', 'ambalaj 1 kg'], TRUE, 'nu', NULL, current_timestamp);

INSERT INTO produse (nume, descriere, pret, tip_produs, categorie_prod, greutate, dimensiune, specificatii_tehnice, uz_multiplu, reparat, imagine, data_adaugare)
VALUES ('Foarfecă pentru gard viu', 'Foarfecă pentru tăierea gardurilor vii, cu lame din oțel', 39.99, 'gradina', 'comuna', 250, 10, ARRAY['lama inoxidabila', 'maner din lemn'], TRUE, 'nu', 'gard-viu.jpg', current_timestamp);

INSERT INTO produse (nume, descriere, pret, tip_produs, categorie_prod, greutate, dimensiune, specificatii_tehnice, uz_multiplu, reparat, imagine, data_adaugare)
VALUES ('Set unelte grădinărit', 'Set de unelte pentru grădinărit, cu mâner ergonomic', 49.99, 'gradina', 'comuna', 800, 15, ARRAY['include: grebla, lopată, foarfecă', 'mâner ergonomic'], TRUE, 'nu', 'unelte.jpg', current_timestamp);

INSERT INTO produse (nume, descriere, pret, tip_produs, categorie_prod, greutate, dimensiune, specificatii_tehnice, uz_multiplu, reparat, imagine, data_adaugare)
VALUES ('Îngrășământ organic', 'Îngrășământ organic pentru plantele de grădină, 100% natural', 19.99, 'gradina', 'aniversara', 500, 40, ARRAY['conține: compost de frunze, gunoi de grajd', 'ambalaj 5 kg'], TRUE, 'nu', NULL, current_timestamp);

INSERT INTO produse (nume, descriere, pret, tip_produs, categorie_prod, greutate, dimensiune, specificatii_tehnice, uz_multiplu, reparat, imagine, data_adaugare)
VALUES ('Covor cauciuc', 'Covor antiderapant din cauciuc pentru grădină sau terasă', 34.99, 'gradina', 'aniversara', 1200, 30, ARRAY['material: cauciuc', 'dimensiuni 1x1.5 metri'], TRUE, 'nu', 'covor.jpg', current_timestamp);


CREATE TYPE webbd.roluri AS ENUM('admin', 'moderator', 'comun');


CREATE TABLE IF NOT EXISTS webbd.utilizatori (
   id serial PRIMARY KEY,
   username VARCHAR(50) UNIQUE NOT NULL,
   nume VARCHAR(100) NOT NULL,
   prenume VARCHAR(100) NOT NULL,
   parola VARCHAR(500) NOT NULL,
   rol roluri NOT NULL DEFAULT 'comun',
   email VARCHAR(100) NOT NULL,
   culoare_chat VARCHAR(50) NOT NULL,
   data_adaugare TIMESTAMP DEFAULT current_timestamp,
   cod character varying(200),
   confirmat_mail boolean DEFAULT false,
   poza VARCHAR(200)
);

CREATE TABLE IF NOT EXISTS webbd.accesari (
   id serial PRIMARY KEY,
   ip VARCHAR(100) NOT NULL,
   user_id INT NULL REFERENCES utilizatori(id),
   pagina VARCHAR(500) NOT NULL,
   data_accesare TIMESTAMP DEFAULT current_timestamp
);

commit;